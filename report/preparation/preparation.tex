This project, by nature, combines a variety of disciplines and technologies, including, but not limited to, computer vision, sensing and signal processing. 
Before being able to proceed with the project, understanding the required topics in each of these respective fields was critical. Several relevant topics are outlined 
and described in relation to this project.

\section{Heart rate sensing}
Before attempting to develop a system which can estimate the heart rate of a user without physical contact, it is useful to understand how traditional heart rate sensors work.
Although it is clear that a non-contact system is constrained by different requirements, it is common when developing low fidelity sensors to begin by attempting to mimic high fidelity alternatives. \\\\
This project can be viewed as the development of a virtual sensor\footnote{A sensor which does not dervie its results from a direct physical realisation of that sensor} that derives its data from an existing sensor, the camera. It is for this reason, that the planning of the project proceeds by, first, understanding the workings of the two main alternative sensors and then reasoning about how one might derive these results from a camera instead.
\\\\
Electrocardiography and photoplethysmography are the two of the most common techniques for measuring heart rate, each of which proceed by measuring alternate phenomena.

\subsection{Electrocardiography}
% Talk about how it works
% The fact it's a gold standard
% But expensive 
An electrocardiogram (ECG) is a recording of the electrical activity of the heart. Electrodes that make contact with the skin, measure how the voltage varies with time.
This is critical since at the beat of a heart there is a very specific electrical pattern that occurs. When the cardiac muscles contract, to cause a heart beat, the muscle cells undergo
\textit{depolarization}. This is a change in the overall electric charge of the cell and is measurable by the electodes. \\\\
Through this mechanism, the electrodes can record each beat of the heart and the average number of beats in a given window, is known as the heart rate.
\begin{figure}[H]
    \includegraphics[width=\textwidth]{example-image-a}
   \caption{An example ECG signal} 
\end{figure}
\noindent
Crucially for this project, the ECG is considered as the highest fidelity means of measuring heart rate. This is because the electrodes can perceive very minor changes in voltage and, thereby, very rarely produce false beats or miss beats of the heart. It is for this reason, that throughout this project it is considered suitable enough to behave as a ground truth for any experiments conducted.
\\\\
It is worth noting that ECG sensors tend to be relatively expensive, and as a result, have fueled the uptake of lower fidelity alternatives.

\subsection{Photoplethysmography}
% Much more common, talk about pulse oximeter
% How the smartwatches have added it 

A common alternative to electrocardiography is photoplethysmography (PPG).
Instead of using an electrical signal to ascertain heart beats, PPG uses an optical sensor to detect changes in the volume of blood passing beneath the skin.
When a heart beat occurs, blood flows outwards from the heart towards the extremities. As a result, there is a perceptible change in the volume of blood passing beneath the skin. Thereby, detecting this change of volume is an alternative proxy to electrical signal for detecting a heart beat.
\\\\
This can be physically realised by a pulse oximeter, which consists of a light that illuminates the skin and a sensor that measures the amount of light absorbed. Typically a pulse oximeter is placed on the end of a finger. An LED emits light on one side of the finger and sensor on the other side measures the amount of light passing through the finger.
Greater volumes of blood will cause more absorption of the light. 
Hence, the amount of light reaching the sensor decreases as the blood reaches the blood vessels between the LED and light sensor.
\begin{figure}[H]
    \includegraphics[width=\textwidth]{example-image-b}
   \caption{An diagram outlining the functioning of a pulse oximeter} 
\end{figure}
\noindent
\begin{figure}[H]
    \includegraphics[width=\textwidth]{example-image-b}
   \caption{An example PPG signal} 
\end{figure}
\noindent
Given this, heart beats can be recognised as peaks in the signal. In this form, pulse oximetry is of high fidelity and is commmonly used in medical scenarios.
However, this requires a relatively stationary finger and, as a result, is not considered practical for sporting activities. In this sense, this form of PPG sensing is not of greater availability than an ECG. As a result, more practical PPG sensors have been developed and incorporated into wearable devices. 

\subsubsection{Wearable PPG sensors}
% Since it's on the wrist it adds a lot of noise, lots of cartilage present which obscures light
% Also sensor is not on the otherside of the skin, it measures reflectance instead
% Energy constraints so low sampling rate
% Movement of wrist
% All of these mean there is a large decrease in fidelity between pulse oximeter and wrist based PPG
So called smartwatches are one of the most common classes of wearable devices and are readily equipped with wrist-based PPG sensors.
The above description of pulse oximetry requires many adaptations to be suitable for use on a wearable. Understanding these modifications paints a wider picture as to 
the cost in fidelity of making such a sensor wearable.
\\\\
Since the PPG sensor is placed on the wrist it doesn't measure the amount of light absorbed but the amount of light reflected. This is because the wrist, as opposed to the finger, contains much more cartilage
so it is not feasible to measure the amount of light passing all the way through the tissue.
The increasing amount of tissue disrupts the light emitted and increases the noise in the resulting signal.
\\\\
% movement
The LEDs present on the underside of the watch will not make perfect contact with the skin. In sporting scenarios where there is lots of movement, this will affect the light passing between the LED and the skin. This acts as an additional source of noise in the signal.
\\\\
Furthermore, sensors on smart devices are often subject to severe energy constraints in an attempt to increase the battery life of the device.
As a result, wearables will tend to use lower sampling rates than that of a medical-grade sensor.
\\\\
Together these factors, and numerous others, result in a much noisier and, as a result, less accurate, PPG signal. 
Although, this comes with the large benefit of providing easier access to heart rate data.
% The most obvious change between a standard pulse oximeter and a wrist-based PPG sensor is that since the sensor is place on the wrist and light cannot 
% Firstly, the PPG sensor in a smartwatch is placed on the wrist rather than on the finger, as is common in a hospital setting. As a result, there is an increasing amount of body matter that disrupts the light signal emitted by the LED. 

\begin{figure}[H]
    \includegraphics[width=\textwidth]{example-image-b}
   \caption{An example PPG signal as taken from a wearable watch} 
\end{figure}
\section{Remote photoplethysmography (rPPG)}
% Give a summary about how the literature proceeds
% Show the mapping between how we use the camera and how PPG sensors work
This project, instead, is concerned with the development of a virtual PPG sensor which can infer the heart rate of a user from a camera only.
That is, without an LED, as present in a wearable device or pulse oximeter, and without a dedicated light sensor in contact with the skin. 
This is generally denoted in the literature as \textit{remote photoplethysmography} (rPPG) and is an active area of research.
\\\\
The most obvious approach to designing such a system, is to attempt to map the data returned by a camera onto one of the two methods of heart rate sensing described. In other words, to attempt 
to mimic an already existing, well-developed sensor.
Since a camera cannot, as far as I am aware, measure electrical signals at a distance, mimicing an ECG is not a feasible approach. PPG sensors, on the other hand, are based on measuring light intensity, which is precisely the same data captured by a camera.
\\\\
A camera works by recording the amount of light that reaches each sensor in an array. As a result, assuming that we have a camera of high enough resolution, one can measure the intensity of light 
at various points in the scene. The impressive results of early research into rPPG systems is that this can be achieved by a regular webcam or smartphone camera.
\\\\
% talk about difficulties of distance + what pixels to consider
% benefit of we can consider more points which might improve resistance to noise
% question if being able to consider more pixels provides an overall benefit over reduced distance
% subject to lighting conditions.
% Given some light source in the background, this is equivalent to the amount of light reflected by each point in 
Clearly an rPPG system is different to both the pulse oximeter and a wrist-based PPG sensor, although it attempts to measure the same phenomenon.
These differences form the basis of its tradeoffs as a sensor. For example, since a camera is likely to be at a greater distance than both of the other PPG sensors described, it is even more
subject to noise caused by lighting conditions. However, cameras contain much larger numbers of light sensors and so can consider more points. There exists a balance between the number and 
reliability of each measurement. Although it is difficult to evaluate which sensors are favoured by this balance based on intuition alone.

\subsection{Literature review}
\label{ref:literature_review}
% Look at existing literature
% talk about how literature says that easiest to get data from the face
% blood vessels near the surface of the skin
\paragraph{}


\subsection{Extensions to current literature}
% structure argument around increasing availability
% Most literature reports heavily on accuracy in stationary cases => not robust
% Little report on movement and changing distance => extension of the project
% Few efforts to describe performance and few optimisations => important for availability
% since rPPG fundamentally is an effort to increase availability, it's useless to have some offline model that takes ages to run
% Most consider all the pixels in the bounding box of the face => makes sense because they're not 
% considering motion and are at close distances so resistance to noise is less important
Remote heart rate sensing should be viewed as a means of widening access to health data. Under the assumption that cameras are more widespread than wearable devices, this must be the case.
Large proportions of the literature report heavily on accuracy, clearly this is valid, since inaccurate measurements could mislead users. However, if the earlier argument is to be believed, then 
performance and robustness are of equal importance. That is, the computations involved must be achievable in a reasonable amount of time on a standard computing device. 
Furthermore, heart rate estimations must be robust to changing conditions or, at the very least, their failure scenarios should be well documented. 
Under this analysis, several extensions to the current literature were formulated and researched throughout the project:
\begin{itemize}
    \item document the performance of associated algorithms and attempt to achieve reasonable performance on standard devices
    \item investigate the effect of motion and distance on accuracy.
\end{itemize}


\section{Relevant computer vision techniques}
Remote heart rate sensing operates directly on a camera stream. To such end, understanding the composition of frames is a critical 
aspect of the system, in the same way that an ECG relies on interpreting electrical signals. In Section \ref{ref:literature_review} it was stated that it is widely believed that 
rPPG is easiest to achieve by considering pixels in the face of the user. So face detection, a common task in the field of Computer Vision, is required.
\subsection{Face detection}
% Talk about viola-jones and why it sucks
% Talk about movement towards neural net based solutions 
\paragraph{Viola-Jones algorithm}
\paragraph{Neural network approaches}

\subsection{Optical flow}
% Describe the optimisation problem
% Why it often works poorly for long periods of time
% Descibe Lucas-Kanade

\subsection{Harris corner detection}
% Describe algorithm and why it is useful
% idea is tracking certain points are easier than others

% \section{Conditional Random Fields}
% \section{Semantic Segmentation}
\section{Approaches to signal processing}

\subsection{Independent Component Analysis}
\subsection{Principal Component Analysis}
\subsection{Fourier transformations}

% \section{Halide}
% \section{RenderScript}
% \section{Differentiable Programming}


\section{Languages and tooling}
\subsection{Languages}
\paragraph{Python}
% large provisions for rapid development
\paragraph{Kotlin}
% Power of the JVM which has lots of libraries
% Directly targets the Android OS

\subsection{Libraries}
\paragraph{OpenCV}
\paragraph{Mobile Vision API}


\section{Starting Point}
% Courses this year which were relevant: Mobile and sensor systems, Computer Vision, Information Theory
% did not take DSP course but read the DSP notes

\section{Requirements analysis}


\section{Professional practice}
% planning 
% prototyping leverages speed of development in python
% android implementation completes the movement towards higher availability but overall focus was on the Python implementation